<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>User Online Status & Chat</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Heroicons CDN -->
  <script src="https://unpkg.com/heroicons@2.0.18/dist/heroicons.min.js"></script>
</head>
<body class="min-h-screen bg-slate-100 flex items-center justify-center p-4">
  <div class="w-full max-w-3xl shadow-xl bg-white rounded-lg overflow-hidden">
    <!-- Card Header -->
    <div class="bg-sky-50">
      <div class="text-2xl font-bold text-center text-sky-800 flex items-center justify-center p-4">
        <!-- Users Icon -->
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a4 4 0 00-3-3.87M9 20h5v-2a4 4 0 00-3-3.87M12 11a4 4 0 100-8 4 4 0 000 8z" />
        </svg>
        <span id="card-title">User Online Status</span>
      </div>
    </div>
    
    <!-- Card Content -->
    <div class="p-6">
      <!-- User List View -->
      <div id="user-list-view">
        <!-- Search Bar -->
        <div class="flex items-center mb-4">
          <input type="text" id="search-input" placeholder="Search users..." class="flex-grow mr-2 px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500">
          <button id="search-button" class="px-4 py-2 border rounded-md text-sky-500 hover:bg-sky-100">
            <!-- Search Icon -->
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
          </button>
        </div>
        
        <!-- Online Users Count -->
        <div class="mb-4 text-sm text-sky-700 font-medium">
          <span id="online-count">0</span> user<span id="online-text">s</span> online
        </div>
        
        <!-- Users Scroll Area -->
        <div class="h-80 rounded-md border p-4 overflow-y-auto">
          <ul id="users-list" class="space-y-4">
            <!-- Users will be dynamically inserted here -->
          </ul>
        </div>
      </div>
      
      <!-- Chat View -->
      <div id="chat-view" class="hidden">
        <!-- Back Button -->
        <button id="back-button" class="flex items-center mb-4 text-sky-500 hover:text-sky-700">
          <!-- Arrow Left Icon -->
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
          </svg>
          Back to User List
        </button>
        
        <!-- Chat Messages Scroll Area -->
        <div class="h-64 rounded-md border p-4 overflow-y-auto mb-4" id="chat-messages">
          <!-- Chat messages will be dynamically inserted here -->
        </div>
        
        <!-- New Message Input -->
        <div class="flex items-center space-x-2">
          <input type="text" id="new-message-input" placeholder="Type a message..." class="flex-grow px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500">
          <button id="send-button" class="px-4 py-2 bg-sky-500 text-white rounded-md hover:bg-sky-600">
            <!-- Send Icon -->
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7-7 7M5 12h16" />
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- JavaScript for Interactivity -->
  <script>
    // Sample Users Data
    const users = [
      { id: 1, name: "Alice Johnson", avatar: "https://via.placeholder.com/80", online: true, lastSeen: "Just now" },
      { id: 2, name: "Bob Smith", avatar: "https://via.placeholder.com/80", online: false, lastSeen: "5 minutes ago" },
      { id: 3, name: "Charlie Brown", avatar: "https://via.placeholder.com/80", online: true, lastSeen: "Just now" },
      { id: 4, name: "Diana Prince", avatar: "https://via.placeholder.com/80", online: false, lastSeen: "1 hour ago" },
      { id: 5, name: "Ethan Hunt", avatar: "https://via.placeholder.com/80", online: true, lastSeen: "Just now" },
      { id: 6, name: "Fiona Gallagher", avatar: "https://via.placeholder.com/80", online: false, lastSeen: "2 days ago" },
      { id: 7, name: "George Lucas", avatar: "https://via.placeholder.com/80", online: true, lastSeen: "Just now" },
      { id: 8, name: "Hannah Montana", avatar: "https://via.placeholder.com/80", online: false, lastSeen: "1 week ago" },
    ];

    let filteredUsers = [...users];
    let selectedUser = null;
    let chatMessages = [];
    
    // DOM Elements
    const usersList = document.getElementById('users-list');
    const searchInput = document.getElementById('search-input');
    const searchButton = document.getElementById('search-button');
    const onlineCount = document.getElementById('online-count');
    const onlineText = document.getElementById('online-text');
    const userListView = document.getElementById('user-list-view');
    const chatView = document.getElementById('chat-view');
    const cardTitle = document.getElementById('card-title');
    const backButton = document.getElementById('back-button');
    const chatMessagesContainer = document.getElementById('chat-messages');
    const newMessageInput = document.getElementById('new-message-input');
    const sendButton = document.getElementById('send-button');

    // Initialize Users List
    function renderUsers() {
      usersList.innerHTML = '';
      filteredUsers.forEach(user => {
        const li = document.createElement('li');
        li.className = `flex items-center space-x-4 p-3 bg-white rounded-lg shadow-sm transition-all duration-200 hover:shadow-md ${user.online ? 'cursor-pointer' : ''}`;
        if (user.online) {
          li.addEventListener('click', () => handleUserClick(user));
        }

        // Avatar
        const avatarDiv = document.createElement('div');
        avatarDiv.className = 'h-12 w-12 relative';
        const avatarImg = document.createElement('img');
        avatarImg.src = user.avatar;
        avatarImg.alt = user.name;
        avatarImg.className = 'h-12 w-12 rounded-full';
        avatarDiv.appendChild(avatarImg);

        // User Info
        const userInfo = document.createElement('div');
        userInfo.className = 'flex-grow';
        const nameP = document.createElement('p');
        nameP.className = 'font-semibold text-sky-800';
        nameP.textContent = user.name;
        const statusP = document.createElement('p');
        statusP.className = 'text-sm text-gray-500';
        statusP.textContent = user.online ? 'Active now' : `Last seen: ${user.lastSeen}`;
        userInfo.appendChild(nameP);
        userInfo.appendChild(statusP);

        // Badge
        const badge = document.createElement('span');
        badge.className = `ml-auto px-2 py-1 text-xs font-medium rounded-full ${user.online ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'}`;
        badge.textContent = user.online ? 'Online' : 'Offline';

        li.appendChild(avatarDiv);
        li.appendChild(userInfo);
        li.appendChild(badge);
        usersList.appendChild(li);
      });

      // Update Online Count
      const onlineUsers = filteredUsers.filter(user => user.online).length;
      onlineCount.textContent = onlineUsers;
      onlineText.textContent = onlineUsers !== 1 ? 's' : '';
    }

    // Handle Search
    function handleSearch() {
      const term = searchInput.value.toLowerCase();
      filteredUsers = users.filter(user => user.name.toLowerCase().includes(term));
      renderUsers();
    }

    // Handle User Click
    function handleUserClick(user) {
      if (user.online) {
        selectedUser = user;
        cardTitle.textContent = `Chat with ${user.name}`;
        userListView.classList.add('hidden');
        chatView.classList.remove('hidden');
        // Initialize Chat Messages
        chatMessages = [
          { id: 1, sender: user.name, content: "Hey there!", time: "2:30 PM" },
          { id: 2, sender: "You", content: "Hi! How are you?", time: "2:31 PM" },
          { id: 3, sender: user.name, content: "I'm good, thanks! How about you?", time: "2:32 PM" },
        ];
        renderChatMessages();
      }
    }

    // Render Chat Messages
    function renderChatMessages() {
      chatMessagesContainer.innerHTML = '';
      chatMessages.forEach(message => {
        const messageDiv = document.createElement('div');
        messageDiv.className = `flex ${message.sender === "You" ? "justify-end" : "justify-start"} mb-4`;

        const messageBubble = document.createElement('div');
        messageBubble.className = `max-w-[70%] p-3 rounded-lg ${message.sender === "You" ? "bg-sky-500 text-white" : "bg-gray-200"}`;

        const senderP = document.createElement('p');
        senderP.className = 'text-sm font-semibold mb-1';
        senderP.textContent = message.sender;

        const contentP = document.createElement('p');
        contentP.textContent = message.content;

        const timeP = document.createElement('p');
        timeP.className = 'text-xs text-right mt-1 opacity-70';
        timeP.textContent = message.time;

        messageBubble.appendChild(senderP);
        messageBubble.appendChild(contentP);
        messageBubble.appendChild(timeP);
        messageDiv.appendChild(messageBubble);
        chatMessagesContainer.appendChild(messageDiv);
      });

      // Scroll to bottom
      chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;
    }

    // Handle Send Message
    function handleSendMessage() {
      const message = newMessageInput.value.trim();
      if (message) {
        const newMsg = {
          id: chatMessages.length + 1,
          sender: "You",
          content: message,
          time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
        };
        chatMessages.push(newMsg);
        renderChatMessages();
        newMessageInput.value = '';
      }
    }

    // Handle Back Button
    function handleBack() {
      selectedUser = null;
      cardTitle.textContent = "User Online Status";
      chatView.classList.add('hidden');
      userListView.classList.remove('hidden');
    }

    // Event Listeners
    searchButton.addEventListener('click', handleSearch);
    searchInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        handleSearch();
      }
    });
    backButton.addEventListener('click', handleBack);
    sendButton.addEventListener('click', handleSendMessage);
    newMessageInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        handleSendMessage();
      }
    });

    // Initial Render
    renderUsers();
  </script>
</body>
</html>
